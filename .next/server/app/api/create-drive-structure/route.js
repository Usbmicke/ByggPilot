"use strict";(()=>{var e={};e.id=379,e.ids=[379],e.modules={19993:e=>{e.exports=require("googleapis")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84095:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>h,requestAsyncStorage:()=>g,routeModule:()=>p,serverHooks:()=>v,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{POST:()=>c});var i=r(49303),o=r(88716),s=r(60670),n=r(87070),l=r(19993),u=r(37007);async function d(e,t,r){let a={name:t,mimeType:"application/vnd.google-apps.folder",...r&&{parents:[r]}};try{let t=await e.files.create({requestBody:a,fields:"id"});return console.log(`Folder created with ID: ${t.data.id}`),t.data.id}catch(e){throw console.error(`Error creating folder "${t}":`,e),e}}async function c(e){try{let t=e.headers.get("Authorization")?.split("Bearer ")[1];if(!t)return n.NextResponse.json({error:"Unauthorized"},{status:401});let r=await u.Z.auth().verifyIdToken(t),a=(await u.Z.auth().getUser(r.uid)).displayName||"Ok\xe4nt F\xf6retag",i=new l.google.auth.GoogleAuth({credentials:JSON.parse(process.env.FIREBASE_SERVICE_ACCOUNT_KEY_JSON),scopes:["https://www.googleapis.com/auth/drive"]}),o=l.google.drive({version:"v3",auth:i});console.log("Starting to create folder structure...");let s=`ByggPilot - ${a}`,c=await d(o,s);if(!c)throw Error("Could not create root folder.");await d(o,"01_Kunder & Anbud",c),await d(o,"02_P\xe5g\xe5ende Projekt",c),await d(o,"03_Avslutade Projekt",c);let p=await d(o,"04_F\xf6retagsmallar",c),g=await d(o,"05_Bokf\xf6ringsunderlag",c);if(p&&(await o.files.create({requestBody:{name:"Mall - Offert",parents:[p]}}),await o.files.create({requestBody:{name:"Mall - Faktura",parents:[p]}})),g){let e=await d(o,"2025",g);e&&(await d(o,"Q1_Kvitton",e),await d(o,"Q2_Kvitton",e),await d(o,"Q3_Kvitton",e),await d(o,"Q4_Kvitton",e))}return console.log("Folder structure created successfully!"),n.NextResponse.json({success:!0,message:"Mappstruktur skapad!",rootFolderId:c})}catch(e){return console.error("Error creating folder structure:",e),n.NextResponse.json({error:"Failed to create folder structure",details:e.message},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/create-drive-structure/route",pathname:"/api/create-drive-structure",filename:"route",bundlePath:"app/api/create-drive-structure/route"},resolvedPagePath:"/workspaces/ByggPilot/src/app/api/create-drive-structure/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:v}=p,w="/api/create-drive-structure/route";function h(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:f})}},37007:(e,t,r)=>{r.d(t,{Z:()=>o});let a=require("firebase-admin");var i=r.n(a);if(!i().apps.length)try{i().initializeApp({credential:i().credential.applicationDefault()}),console.log("Firebase Admin SDK initialized successfully using Application Default Credentials.")}catch(e){throw console.error("CRITICAL: Firebase Admin SDK initialization failed.",e.stack),Error("Could not initialize Firebase Admin SDK. Check server logs.")}let o=i()}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,972],()=>r(84095));module.exports=a})();